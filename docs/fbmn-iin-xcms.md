# IIN with XCMS-CAMERA

## Introduction

The use of XCMS and CAMERA to generate IIN relies on two custom utility functions (`getFeatureAnnotations` and `getEdgelist`) to extract and export MS1 based feature and edge annotations (i.e. grouping of features to adduct/isotope groups of the same compound). In addition, the utility function `formatSpectraForGNPS` is also used to export MS2 spectra.


## Development

These custom functions are available in the GitHub repository [https://github.com/jorainer/xcms-gnps-tools](https://github.com/jorainer/xcms-gnps-tools).

Representative R-markdown documents and python scripts are available on [http://ccms-ucsd.github.io/GNPSDocumentation/fbmn-iin-xcms](http://ccms-ucsd.github.io/GNPSDocumentation/fbmn-iin-xcms). 

XCMS3 GitHub repository: [https://github.com/sneumann/xcms](https://github.com/sneumann/xcms)
This work builds on the efforts of our many colleagues, please cite their work: 

## Citations

**For IIMN**: Schmid R., Petras D., Nothias LF, et al. [Ion Identity Molecular Networking for mass spectrometry-based metabolomics in the GNPS Environment](https://www.nature.com/articles/s41467-021-23953-9). Nat. Comm. 12, 3832 (2021).

**For FBMN**: Nothias, L.-F., Petras, D., Schmid, R. et al. [Feature-based molecular networking in the GNPS analysis environment](https://www.nature.com/articles/s41592-020-0933-6). Nat. Methods 17, 905–908 (2020).

**For GNPS**: Wang, M. et al. [Sharing and community curation of mass spectrometry data with Global Natural Products Social Molecular Networking](https://doi.org/10.1038/nbt.3597). Nat. Biotechnol. 34, 828–837 (2016).

**For XCMS** 1) Tautenhahn R, Boettcher C, Neumann S. [Highly sensitive feature detection for
high resolution LC/MS](https://doi.org/10.1186/1471-2105-9-504) BMC
Bioinformatics, 9:504 (2008).

**For XCMS** 2) Smith, C.A., Want, E.J., O'Maille, G., Abagyan,R., Siuzdak, G. [XCMS: Processing
mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching and identification.](https://pubs.acs.org/doi/10.1021/ac051437y)
Analytical Chemistry, 78, 779–787 (2006).

**For CAMERA** 1): Kuhl, C., Tautenhahn, R., Böttcher, C., Larson, T. R. & Neumann, S. [CAMERA: an integrated strategy for compound spectra extraction and annotation of liquid chromatography/mass spectrometry data sets.](https://doi.org/10.1021/ac202450g) Anal. Chem. 84, 283–289 (2012)

**For CAMERA** 2): Treutler, H. & Neumann, S. [Prediction, Detection, and Validation of Isotope Clusters in Mass Spectrometry Data](http://dx.doi.org/10.3390/metabo6040037). Metabolites 6, (2016)

## Running the FBMN IIN workflow with XCMS-CAMERA

**Step 1**: Process your non-targeted LC-MS/MS data with XCMS-CAMERA following the [FBMN documentation guidelines](featurebasedmolecularnetworking-with-xcms3.md).

**Step 2**: Export the Supplementary Annotations/Pairs:

The use of XCMS and CAMERA to generate IIN relies on two custom utility functions:

`getFeatureAnnotations`: extracts and exports MS1 based feature annotation. It contains the adduct/isotope annotations generated by CAMERA.

`getEdgelist`: extracts and exports the Supplementary Pairs file that contains related pairs (i.e. from peak shape correlation analysis, etc) . 

Note that the utility function `formatSpectraForGNPS` of the FBMN must also be used to export MS2 spectra as MGF.

**Step 3**: Run a FBMN job and add the Supplementary Pairs file following the [main IIN documentation](fbmn-iin.md)
[See an example of job with IIN job with XCMS-CAMERA](https://gnps.ucsd.edu/ProteoSAFe/status.jsp?task=1602e1709167425cac1c5441d9919a57)

For visualizing results in Cytoscape. Please refer to the [main FBMNxIIN documentation](fbmn-iin.md).

See our tutorial below for detailed example.


### Tutorials

See our FBMN IIN tutorial with XCMS using a subset of the American Gut Project samples on this repository [DorresteinLaboratory/XCMS3_FeatureBasedMN/](https://github.com/DorresteinLaboratory/XCMS3_FeatureBasedMN/).


## Acknowledgements

This integration was made possible by Johannes Rainer (Eurac Research) and Mar Garcia-Aloy (Eurac Research). 

## Page Contributions

{{ git_page_authors }}
