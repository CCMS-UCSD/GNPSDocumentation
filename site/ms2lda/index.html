



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.1">
    
    
      
        <title>MS2LDA and MotifDB Substructure Discovery - GNPS Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.3020aac5.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-8412213-5", "ccms-ucsd.github.io")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#ms2lda-substructure-discovery" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="GNPS Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              GNPS Documentation
            </span>
            <span class="md-header-nav__topic">
              MS2LDA and MotifDB Substructure Discovery
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="GNPS Documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    GNPS Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="GNPS Introduction" class="md-nav__link">
      GNPS Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../isgnpsright/" title="Is my data compatible with GNPS?" class="md-nav__link">
      Is my data compatible with GNPS?
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../faq/" title="Frequently Asked Questions" class="md-nav__link">
      Frequently Asked Questions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../superquickstart/" title="Superquick Start Guide" class="md-nav__link">
      Superquick Start Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../quickstart/" title="Quick Start Guide" class="md-nav__link">
      Quick Start Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../gnpsanalysisoverview/" title="GNPS Analysis Tools Overview" class="md-nav__link">
      GNPS Analysis Tools Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Mass Spec/Computational Background
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Mass Spec/Computational Background
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../massspecbackground/networkingtheory/" title="Molecular Networking" class="md-nav__link">
      Molecular Networking
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Data Preparation/Upload
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Data Preparation/Upload
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../fileconversion/" title="Mass Spectrometry File Conversion" class="md-nav__link">
      Mass Spectrometry File Conversion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fileupload/" title="GNPS File Upload" class="md-nav__link">
      GNPS File Upload
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Recommended Data Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Recommended Data Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../networking/" title="Molecular Networking" class="md-nav__link">
      Molecular Networking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../networkingviews/" title="Molecular Networking Views" class="md-nav__link">
      Molecular Networking Views
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../librarysearch/" title="Spectral Library Search" class="md-nav__link">
      Spectral Library Search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../masst/" title="MASST Search (Mass Search Tool)" class="md-nav__link">
      MASST Search (Mass Search Tool)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../resultviews/" title="Result Views Navigation" class="md-nav__link">
      Result Views Navigation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10" checked>
    
    <label class="md-nav__link" for="nav-10">
      Advanced Data Analysis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Advanced Data Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../cytoscape/" title="Molecular Networking in Cytoscape" class="md-nav__link">
      Molecular Networking in Cytoscape
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dereplicator/" title="Dereplicator" class="md-nav__link">
      Dereplicator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nap/" title="Network Annotation Propagation (NAP)" class="md-nav__link">
      Network Annotation Propagation (NAP)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10-4" type="checkbox" id="nav-10-4">
    
    <label class="md-nav__link" for="nav-10-4">
      Feature Based Molecular Networking
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-10-4">
        Feature Based Molecular Networking
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../featurebasedmolecularnetworking/" title="FBMN Overview" class="md-nav__link">
      FBMN Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../featurebasedmolecularnetworking-with-mzmine2/" title="MZmine2 Documentation" class="md-nav__link">
      MZmine2 Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../featurebasedmolecularnetworking-with-ms-dial/" title="MS-DIAL Documentationn" class="md-nav__link">
      MS-DIAL Documentationn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../featurebasedmolecularnetworking-with-xcms3/" title="XCMS3 Documentation" class="md-nav__link">
      XCMS3 Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../featurebasedmolecularnetworking-with-openms/" title="OpenMS Documentation" class="md-nav__link">
      OpenMS Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../featurebasedmolecularnetworking-with-metaboscape/" title="MetaboScape Documentation" class="md-nav__link">
      MetaboScape Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../featurebasedmolecularnetworking-cytoscape/" title="Cytoscape Documentation" class="md-nav__link">
      Cytoscape Documentation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="MS2LDA and MotifDB Substructure Discovery" class="md-nav__link md-nav__link--active">
      MS2LDA and MotifDB Substructure Discovery
    </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Community/Social Features
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        Community/Social Features
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-1" type="checkbox" id="nav-11-1">
    
    <label class="md-nav__link" for="nav-11-1">
      Spectral Libraries
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-11-1">
        Spectral Libraries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../browselibraries/" title="Browsing Reference Spectral Libraries" class="md-nav__link">
      Browsing Reference Spectral Libraries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spectrumcuration/" title="Reference Spectral Library Curation" class="md-nav__link">
      Reference Spectral Library Curation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../batchupload/" title="Reference Spectral Library Batch Addition" class="md-nav__link">
      Reference Spectral Library Batch Addition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../downloadlibraries/" title="Downloading Reference Spectral Libraries" class="md-nav__link">
      Downloading Reference Spectral Libraries
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11-2" type="checkbox" id="nav-11-2">
    
    <label class="md-nav__link" for="nav-11-2">
      Datasets
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-11-2">
        Datasets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../datasets/" title="Dataset Creation/Sharing" class="md-nav__link">
      Dataset Creation/Sharing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../continuousid/" title="Continuous Identification" class="md-nav__link">
      Continuous Identification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../moleculeexplorer/" title="Molecule Explorer" class="md-nav__link">
      Molecule Explorer
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../user/" title="User Page" class="md-nav__link">
      User Page
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      Tutorial Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        Tutorial Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorials/bacterianetworking/" title="Molecular Networking - Analog Discovery in Microbial Extracts" class="md-nav__link">
      Molecular Networking - Analog Discovery in Microbial Extracts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorials/americangutmzmine/" title="Feature Based Molecular Networking with MZmine2 - Microbiome Molecules in Fecal Samples in American Gut Project" class="md-nav__link">
      Feature Based Molecular Networking with MZmine2 - Microbiome Molecules in Fecal Samples in American Gut Project
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tutorials/featurebasedgnps/" title="Feature Based Molecular Networking - GNPS" class="md-nav__link">
      Feature Based Molecular Networking - GNPS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      Presentation Materials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        Presentation Materials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../logos/" title="Logos" class="md-nav__link">
      Logos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../changelog/" title="Change Log" class="md-nav__link">
      Change Log
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contact/" title="Contact" class="md-nav__link">
      Contact
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../workshops/" title="GNPS Workshops" class="md-nav__link">
      GNPS Workshops
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="ms2lda-substructure-discovery">MS2LDA Substructure Discovery</h1>
<p><img alt="img" src="../img/ms2lda/banner.png" /></p>
<p>MS2LDA is a tool that decomposes molecular fragmentation data derived from large metabolomics experiments into annotated Mass2Motifs or discovers Mass2Motifs from experimental data. Mass2Motifs are fragmentation patterns of often co-occurring mass fragment peaks and/or neutral losses that often represent molecular substructures. Check out the <a href="http://ms2lda.org/">MS2LDA website</a> here where you can find more information, browse through data sets, and sign up for an account to run the Mass2Motif discovery on your own data. At GNPS, we are working with the MS2LDA team to integrate both workflows which allows users to map Mass2Motif occurrences in their Molecular Families.</p>
<p>It is now also possible to run MS2LDA analyses through the GNPS interface <a href="https://gnps.ucsd.edu/ProteoSAFe/index.jsp?params=%7B%22workflow%22:%22MS2LDA_MOTIFDB%22%7D">here</a> which will lead to the below displayed job entry page.</p>
<p><img alt="img" src="../img/ms2lda/overview.png" /></p>
<p>In this section, it is explained what input files are needed, how the parameters can be chosen, and what kind of output you get.
Finally, it is explained how the obtained MS2LDA model can be further explored on the <a href="www.ms2lda.org">MS2LDA</a> website by uploading the generated dict file.</p>
<h1 id="collecting-the-right-input-files">Collecting the right input files</h1>
<p>After providing the GNPS analysis with a title, the right input files are needed to start an MS2LDA analysis:</p>
<ul>
<li>Required: Spectral data (MGF file) which can be downloaded from a processed Molecular Networking job</li>
<li>Required: Edges file including selfloops which can be downloaded from a processed Molecular Networking job (i.e., typically found in the networkedges_selfloop folder within the downloaded GNPS job folder)</li>
<li>Optional: MS1 peak abundance information (CSV file generated by MzMine) - choose "MzMine2 (Feature based Molecular Networking)" workflow if this file is provided. This will allow you to perform MS1 differential analysis within the MS2LDA web app to find discriminate Mass2Motifs between groups.</li>
</ul>
<p><img alt="img" src="../img/ms2lda/InputData.png" /></p>
<p>After selecting the input files, the right MGF Source needs to be selected: "MSCluster" for a classical Molecular Networking derived clustered MGF file, and "MzMine2" for a Feature based Molecular Networking derived MGF file.</p>
<h2 id="quick-start-from-processed-molecular-network">Quick start from processed Molecular Network</h2>
<p>To facilitate MS2LDA analysis of processed Molecular Networking jobs, in the newest (V2) version under "Advanced Views - Experimental Views" there is a button <u>Analyze with MS2LDA</u> that will bring you directly to the MS2LDA analysis page prefilling the relevant input files (spectral MGF file and edge pair file including selfloops). See also the animated GIF below.
Please note that you can adapt the title and you must check the relevant MS2LDA parameter settings for your data set.</p>
<p><img alt="img" src="../img/ms2lda/MS2LDAfromMolNetw.gif" /></p>
<h1 id="setting-the-ms2lda-parameters">Setting the MS2LDA parameters</h1>
<p>There are three sections of parameters to fill out of which the first is the most important. Default values are provided for all settings, but each of them is dependent on the input data. We provide some guidelines here to ease your choice.</p>
<h2 id="lda-parameters">LDA parameters</h2>
<p><img alt="img" src="../img/ms2lda/LDAparameters.png" /></p>
<p>The "Advanced MS2LDA parameters" displays four parameter values to set. The first is the bin width used to bin the MS2 fragments and losses. Defaults for Q-Exactive (0.005 Da) and ToF (0.01 Da) Data are provided. For instruments like Ion Traps a larger bin width of 0.1 Da is recommended. The appropriate bin width to choose is dependent on the expected mass variation of mass fragments across mass spectra in your data.</p>
<p><img alt="img" src="../img/ms2lda/LDAparameterBinning.png" /></p>
<p>The number of LDA iterations is set to 1000 by default which should work in most cases.</p>
<p>The Minimum MS2 Intensity is meant to filter out the basic noise from the MS/MS spectra. It is recommended to open the inputted MGF file and check the noise levels. Typically they range from 25-200 (ToF Data) to 5000 (Q-Exactive Data). Inclusion of noise will unnecessarily lengten the analysis time and create non-informative Mass2Motifs.</p>
<p>The LDA Free Motifs correspond to the number of "free Mass2Motifs" that are added on top of the prefixed annotated Mass2Motifs from MotifDB. This number depends on your data: if you input a larger number of fragmented molecules (i.e., &gt; 4,000) that includes lots of novel chemistry not present in MotifDB it is best to put the LDA Free Motifs on 300 - 500. If the data set is relatively small with a considerable amount of known chemistry, you best put this number to 50 - 150.</p>
<h2 id="selecting-motifdb-motif-sets">Selecting MotifDB motif sets</h2>
<p>By default all Motif Sets will be imported from <a href="www.ms2lda.org/motifdb">MotifDB</a>. However, it is wise to exclude annotated motif sets of sources that are very distant from the source of your input data. Note that the GNPS and MassBank are annotated Mass2Motifs discovered in reference molecules.</p>
<p><img alt="img" src="../img/ms2lda/LDAparameterMotifDB.png" /></p>
<h2 id="output-networking-file-thresholds">Output Networking file thresholds</h2>
<p>After running MS2LDA, output files are created that include a new networking (edge) file that can be used to create an enriched Molecular Network including Mass2Motif distributions through the Molecular Families. To do so, cut-off values (thresholds) are needed for LDA scores to consider a Mass2Motif to be linked to a molecule or not and how many you want to show in the network. Default values are provided that were found to work well so far.
In <a href="https://pubs.acs.org/doi/abs/10.1021/acs.analchem.7b01391">this</a> publication the two scores are explained: probability and overlap score.</p>
<p><img alt="img" src="../img/ms2lda/LDAoutput_thresholds.png" /></p>
<p>Note that you will have to provide your email address in the appropriate field in order to be notified upon completion of your GNPS-MS2LDA job.</p>
<h1 id="ms2lda-output-files">MS2LDA output files</h1>
<p>Upon succesful completion, you will be able to see the output job page as displayed below:</p>
<p><img alt="img" src="../img/ms2lda/output.png" /></p>
<p>There are different views and files for download available:</p>
<h3 id="view-motif-labels-for-spectra">View Motif Labels for Spectra</h3>
<p>This view displays all the fragmented molecules (scans) and each of the motifs linked to them [above the set thresholds as specified in the Output Networking file thresholds]. 
It can be downloaded as a tab separated file.</p>
<p><img alt="img" src="../img/ms2lda/MotifLabels.png" /></p>
<h3 id="individual-motif-details">Individual Motif Details</h3>
<p>This view displays all molecule-motif links [some molecules have more than one motif linked and will appear multiple times in this table] and also shows the annotation if available from MotifDB.
It can be downloaded as a tab separated file.</p>
<p><img alt="img" src="../img/ms2lda/MotifDetails.png" /></p>
<h3 id="view-pairs-with-motif-edges">View Pairs with Motif Edges</h3>
<p>This view is the new edge file enriched with Motif interactions: note that in the "Interact" column apart from cosine now different Mass2Motifs are listed [above the set thresholds as specified in the Output Networking file thresholds].
It can be downloaded as a tab separated file - this can be used to create a new enriched Molecular Network in CytoScape.</p>
<p><img alt="img" src="../img/ms2lda/PairsMotifEdges.png" /></p>
<h3 id="view-motif-pdf">View Motif PDF</h3>
<p>This displays a PDF report of all the Mass2Motifs. Each Mass2Motif spans two pages with the first page a graphical overview of the relevant mass fragments (red, on top, pointing up) and neutral losses (green, bottom, pointing down) with the y-axis being the intensity which equals the features' probability to be found in the Mass2Motif, and the x-axis being the m/z (rounded up to nominal values in the labels) in Daltons.
The second page displays the top mass fragments and neutral losses with their probabilities.</p>
<h3 id="download-motif-pdf">Download Motif PDF</h3>
<p>This downloads the PDF report as explained in "View Motif PDF".</p>
<h3 id="download-pairs">Download Pairs</h3>
<p>This downloads the new edge file as explained in "View Pairs with Motif Edges".</p>
<h3 id="download-ms2lda-dict">Download MS2LDA Dict</h3>
<p>This downloads the MS2LDA Dict file that houses all the relevant information on the MS2LDA experiment.</p>
<h1 id="analysing-the-ms2lda-results-within-gnps">Analysing the MS2LDA results within GNPS</h1>
<p>The different available views enable a quick overview of the MS2LDA experiment. Especially when annotated Mass2Motifs are found, this could help in further downstream analysis.
However, when no annotation is provided, the Mass2Motif is one of the "free Motifs" that was discovered by LDA. With the MS2LDA Dict file through the MS2LDA web app there are ways to analyse these Mass2Motifs further and also annotate them.</p>
<p>In general, when analysing annotating or novel Mass2Motifs, it is important to keep <a href="http://ms2lda.org/disclaimer/">this</a> in mind!</p>
<h1 id="taking-the-gnps-results-into-the-ms2lda-web-app">Taking the GNPS results into the MS2LDA web app</h1>
<p>After downloading the MS2LSA Dict file from the finished MS2LDA experiment, this can be uploaded into the <a href="www.ms2lda.org">MS2LDA web app</a>. There is a <a href="http://www.ms2lda.org/user_guide/">User Guide</a> available that covers the main functionalities of the MS2LDA web app.</p>
<p>If it is your first time at the MS2LDA web app, make sure you get a login account before continuing. Once logged in, go to the experiments section:</p>
<p><img alt="img" src="../img/ms2lda/AppCreateExperiments.png" /></p>
<p>By default, you arrive on the Create tab which lets you create an MS2LDA experiment from mass spectrometry data. </p>
<p><img alt="img" src="../img/ms2lda/AppAddExp.png" /></p>
<p>Click on the Upload tab, to continue:</p>
<p><img alt="img" src="../img/ms2lda/AppAddExpUpload.png" /></p>
<p>Now, you will have to provide a unique name for the MS2LDA experiment and you can also provide relevant details.
Most importantly, you will need to select the location of the downloaded MS2LDA Dict file under "LDA output file".
Also, you will need to select the bin width as used in the GNPS-MS2LDA workflow ("Bin Width") from the available options.</p>
<p><img alt="img" src="../img/ms2lda/AppUploadDictFile.png" /></p>
<p>After you are ready, you can click "Upload Your Experiment" and the upload will start.</p>
<h2 id="annotating-new-motifs">Annotating new motifs</h2>
<p>Once the MS2LDA dict file finished uploading, you can browse the MS2LDA experiment in the web app like a regular MS2LDa experiment. If you click on the experiment name, multiple tabs will appear:</p>
<p><img alt="img" src="../img/ms2lda/AppExperimentTabsOverview.png" /></p>
<p>Here, you can click on the Summary Page tab which leads you to the summary of the experiment that includes all relevant Tables. For example, the Motif Table can be browsed, sorted, searched, and downloaded as CSV:</p>
<p><img alt="img" src="../img/ms2lda/AppExperimentSummaryPageMotifs.png" /></p>
<p>When clicking on the relevant "free Motif" name a Motif Page will appear where the relevant mass fragment and neutral losses are listed including their scores and a frequency plot. Also, all the spectra the Mass2Motif appears in can be browsed to analyse the nature of the fragmentation pattern.
Importantly, if you can annote the motif with any structural information, this can be provided on top of the page with the Annotation field for the full annotation and the Short Annotation field for a label to display in graphics - make sure to save the Motif Page afterwards! After reloading the Summary Page or the Show Mass2Motif tabs, the annotation(s) will be displayed and are searchable. </p>
<p><img alt="img" src="../img/ms2lda/AppExampleFreeMotifPage.png" /></p>
<p>Finally, on top of the summary page there is a toggle where you can make the entire MS2LDA experiment public. See for example the public <a href="http://ms2lda.org/basicviz/summary/190/">MassBank Experiment</a>.</p>
<h2 id="ms1-differential-analyses-within-the-ms2lda-web-app">MS1 Differential Analyses within the MS2LDA web app</h2>
<p>If the Feature based Molecular Networking workflow was used, the MS1 peak information is available in the MS2LDA Dict file. This can be used to create MS1 analysis to find Mass2Motif that are discriminative between two sample groups.
More information can be found in <a href="http://www.pnas.org/content/113/48/13738.short">this</a> publication and the <a href="http://www.ms2lda.org/user_guide/#ms1_analysis">MS2LDA web app User Guide</a> explains how to set up such an analysis within your experiment.</p>
<h2 id="uploading-annotated-motif-sets-into-motifdb">Uploading annotated motif sets into MotifDB</h2>
<p>This is a future feature that will become available in the course of this year. It will allow you to make your new annotations searchable and usable by the community.</p>
<h1 id="future-directions">Future Directions</h1>
<p>At GNPS, we are working with the MS2LDA team to promote publication of curated sets of Mass2Motifs into <a href="www.ms2lda.org/motifdb">MotifDB</a> that can help to annotate your MS/MS spectra.</p>
<h2 id="citations">Citations</h2>
<p>Have you found MS2LDA to be useful for your data analysis? Please cite the relevant literature from below.</p>
<h3 id="introduction-of-ms2lda-substructure-discovery-algorithm">Introduction of MS2LDA Substructure Discovery algorithm</h3>
<p><a href="http://www.pnas.org/content/113/48/13738.short">van der Hooft, Justin J. J., Joe Wandy, Michael P. Barrett, Karl E.V. Burgess, and Simon Rogers. "Topic modeling for untargeted substructure exploration in metabolomics." Proceedings of the National Academy of Sciences 113, no. 48 (2016): 13738-13743.</a></p>
<h3 id="publication-of-the-ms2ldaorg-web-app-to-discover-and-analyse-mass2motifs">Publication of the MS2LDA.org web app to discover and analyse Mass2Motifs</h3>
<p><a href="https://academic.oup.com/bioinformatics/article/34/2/317/4158166">Wandy, Joe, Yunfeng Zhu, Justin J.J. van der Hooft, Ronan Daly, Michael P. Barrett, and Simon Rogers. "Ms2lda.org: web-based topic modelling for substructure discovery in mass spectrometry." Bioinformatics 34, no. 2 (2018): 317-318.</a></p>
<h3 id="extended-version-of-ms2lda-algorithm-to-handle-multiple-files-at-once">Extended version of MS2LDA algorithm to handle multiple files at once</h3>
<p><a href="https://pubs.acs.org/doi/abs/10.1021/acs.analchem.7b01391">van der Hooft, Justin J. J., Joe Wandy, Francesca Young, Sandosh Padmanabhan, Konstantinos Gerasidimis, Karl E.V. Burgess, Michael P. Barrett, and Simon Rogers. "Unsupervised Discovery and Comparison of Structural Families Across Multiple Samples in Untargeted Metabolomics." Analytical Chemistry 89, no. 14 (2017): 7569-7577.</a></p>
<h3 id="latest-developments-in-ms2ldaorg-introduction-of-motifdb-with-annotated-mass2motif-sets-and-magma-integration-for-mass2motif-annotation-of-reference-compounds">Latest developments in MS2LDA.org: introduction of <a href="http://ms2lda.org/motifdb/">MotifDB</a> with annotated Mass2Motif sets and <a href="http://www.emetabolomics.org">MAGMa</a> integration for Mass2Motif annotation of reference compounds</h3>
<p><a href="https://pubs.rsc.org/en/Content/ArticleLanding/2019/FD/C8FD00235E#!divAbstract">Rogers, Simon, Cher Wei Ong, Joe Wandy, Madeleine Ernst, Lars Ridder, and Justin J.J. van der Hooft. "Deciphering complex metabolite mixtures by unsupervised and supervised substructure discovery and semi-automated annotation from MS/MS spectra." Faraday Discussions themed collection  Challenges in analysis of complex natural mixtures (2019).</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../featurebasedmolecularnetworking-cytoscape/" title="Cytoscape Documentation" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Cytoscape Documentation
              </span>
            </div>
          </a>
        
        
          <a href="../browselibraries/" title="Browsing Reference Spectral Libraries" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Browsing Reference Spectral Libraries
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.dc02f8ce.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>